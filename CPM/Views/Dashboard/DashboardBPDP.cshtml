@{
    ViewData["Title"] = "Dashboard";
}

<div class="content transition animated fadeIn">
    <div class="row">
        <div class="col-lg-12 text-center m-t-md">
            <h1 class="text-success">
                Welcome to System Monitoring
            </h1>

            <p>
                Monitoring seluruh transaksi <b>BPD-PKS</b> RTGS / Kliring atau lainya.
            </p>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-12" style="height:30px">

        </div>
    </div>
    <div class="row">
        <div class="col-lg-3">
            <div class="hpanel">
                <div class="panel-body text-center h-200">
                    <i class="pe-7s-culture fa-4x"></i>

                    <h1 class="m-xs" id="totInHouse">0</h1>

                    <h3 class="no-margins text-success">
                        In House
                    </h3>
                    <small>Informasi jumlah total transaksi In House.</small>
                </div>
                <div class="panel-footer">
                    <i class="fa fa-clock-o"></i> 12-06-2023 11:22:11
                </div>
            </div>
        </div>
        <div class="col-lg-3">
            <div class="hpanel">
                <div class="panel-body text-center h-200">
                    <i class="pe-7s-cloud-upload fa-4x"></i>

                    <h1 class="m-xs" id="totRTGS">0</h1>

                    <h3 class="no-margins text-warning">
                        RTGS
                    </h3>
                    <small>Informasi jumlah total transaksi RTGS.</small>
                </div>
                <div class="panel-footer">
                    <i class="fa fa-clock-o"></i> 12-06-2023 11:22:11
                </div>
            </div>
        </div>
        <div class="col-lg-3">
            <div class="hpanel">
                <div class="panel-body text-center h-200">
                    <i class="pe-7s-display1 fa-4x"></i>

                    <h1 class="m-xs" id="totSKN">0</h1>

                    <h3 class="no-margins text-info">
                        SKN / Kliring
                    </h3>
                    <small>Informasi jumlah total transaksi SKN.</small>
                </div>
                <div class="panel-footer">
                    <i class="fa fa-clock-o"></i> 12-06-2023 11:22:11
                </div>
            </div>
        </div>
        <div class="col-lg-3">
            <div class="hpanel">
                <div class="panel-body text-center h-200">
                    <i class="pe-7s-coffee fa-4x"></i>

                    <h1 class="m-xs">0</h1>

                    <h3 class="no-margins text-danger">
                        Lain-lain
                    </h3>
                    <small>Informasi lain-lain yang belum tersedia.</small>
                </div>
                <div class="panel-footer">
                    <i class="fa fa-clock-o"></i> 12-06-2023 11:22:11
                </div>
            </div>
        </div>
    </div>

    @*<div class="col-md-3">
                <div class="hpanel hbggreen">
                    <div class="panel-body">
                        <div class="text-center">
                            <h3>In House</h3>
                            <p class="text-big font-light">
                                20
                            </p>
                            <small>
                                Informasi jumlah total transaksi In House.
                            </small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="hpanel hbgyellow">
                    <div class="panel-body">
                        <div class="text-center">
                            <h3>RTGS</h3>
                            <p class="text-big font-light">
                                20
                            </p>
                            <small>
                                Informasi jumlah total transaksi RTGS.
                            </small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="hpanel hbgblue">
                    <div class="panel-body">
                        <div class="text-center">
                            <h3>SKN / Kliring</h3>
                            <p class="text-big font-light">
                                20
                            </p>
                            <small>
                                Informasi jumlah total transaksi SKN.
                            </small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="hpanel hbgred">
                    <div class="panel-body">
                        <div class="text-center">
                            <h3>Lain-lain</h3>
                            <p class="text-big font-light">
                                20
                            </p>
                            <small>
                                Informasi lain-lain yang belum tersedia.
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>*@

    <div class="row">
        <div class="col-lg-12">
            <div class="hpanel hgreen">

                <div class="panel-heading">
                    <div class="pull-right">
                        <a class="btn btn-success" id="bTambahUser" data-toggle="tooltip" data-placement="top" title="Tamplikan Lengkap" href="@Url.Action("DaftarInHouse", "BPDP")"><i class="fa fa-th-list"></i></a>
                    </div>
                    <h3 class="m-b-xs">TRANSAKSI IN HOUSE</h3>
                    <small><i class="fa fa-quote-right"></i> Menampilkan 10 transaksi terakhir In House</small>
                </div>

                @*<div class="alert alert-success">
                        <div class="pull-right">
                            <a class="btn btn-success" id="bTambahUser" data-toggle="tooltip" data-placement="top" title="Tamplikan Lengkap" href="@Url.Action("DaftarInHouse", "BPDP")"><i class="fa fa-th-list"></i></a>
                        </div>
                        <h3 class="m-b-xs">TRANSAKSI IN HOUSE</h3>
                        <small><i class="fa fa-quote-right"></i> Menampilkan 10 transaksi terakhir In House</small>
                    </div>*@
                @*<div class="panel-heading">
                    <div class="pull-right">
                        <a class="btn btn-success" id="bTambahUser" data-toggle="tooltip" data-placement="top" title="Tamplikan Lengkap" href="@Url.Action("DaftarInHouse", "BPDP")"><i class="fa fa-th-list"></i></a>
                    </div>
                    <h3 class="m-b-xs">TRANSAKSI IN HOUSE</h3>
                    <small>Menampilkan 10 transaksi terakhir In House</small>
                </div>*@
                <div class="panel-body">
                    <div class="table-responsive">
                        <table id="dtDaftarInHouse" class="table table-striped table-bordered table-hover" cellpadding="0" style="width:100%">
                            <thead>
                                <tr>
                                    <th class="text-center">No</th>
                                    <th class="text-center" hidden>Id</th>
                                    <th class="text-center">No. Trans</th>
                                    <th class="text-center">Tanggal</th>
                                    <th class="text-center">Nama Penerima</th>
                                    <th class="text-center">Rek. Tujuan</th>
                                    <th class="text-center">Nominal</th>
                                    <th class="text-center">Keterangan</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-12">
            <div class="hpanel hyellow">
                @*<div class="alert alert-warning">
                        <div class="pull-right">
                            <a class="btn btn-warning" id="bTambahUser" data-toggle="tooltip" data-placement="top" title="Tamplikan Lengkap" href="@Url.Action("DaftarRTGS", "BPDP")"><i class="fa fa-th-list"></i></a>
                        </div>
                        <h3 class="m-b-xs">TRANSAKSI RTGS</h3>
                        <small><i class="fa fa-quote-right"></i> Menampilkan 10 transaksi terakhir RTGS</small>
                    </div>*@
                <div class="panel-heading">
                    <div class="pull-right">
                        <a class="btn btn-warning" id="bTambahUser" data-toggle="tooltip" data-placement="top" title="Tamplikan Lengkap" href="@Url.Action("DaftarRTGS", "BPDP")"><i class="fa fa-th-list"></i></a>
                    </div>
                    <h3 class="m-b-xs">TRANSAKSI RTGS</h3>
                    <small>Menampilkan 10 transaksi terakhir RTGS</small>
                </div>
                <div class="panel-body">
                    <div class="table-responsive">
                        <table id="dtDaftarRTGS" class="table table-striped table-bordered table-hover" cellpadding="0" style="width:100%">
                            <thead>
                                <tr>
                                    <th class="text-center">No</th>
                                    <th class="text-center" hidden>Id</th>
                                    <th class="text-center">No. Trans</th>
                                    <th class="text-center">Tanggal</th>
                                    <th class="text-center">Nama Penerima</th>
                                    <th class="text-center">Nama Bank</th>
                                    <th class="text-center">Rek. Tujuan</th>
                                    <th class="text-center">Nominal</th>
                                    <th class="text-center">Biaya</th>
                                    <th class="text-center">Keterangan</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-12">
            <div class="hpanel hblue">
                @*<div class="alert alert-info">
                        <div class="pull-right">
                            <a class="btn btn-info" id="bTambahUser" data-toggle="tooltip" data-placement="top" title="Tamplikan Lengkap" href="@Url.Action("DaftarSKN", "BPDP")"><i class="fa fa-th-list"></i></a>
                        </div>
                        <h3 class="m-b-xs">TRANSAKSI SKN / Kliring</h3>
                        <small><i class="fa fa-quote-right"></i> Menampilkan 10 transaksi terakhir SKN / Kliring</small>
                    </div>*@
                <div class="panel-heading">
                    <div class="pull-right">
                        <a class="btn btn-info" id="bTambahUser" data-toggle="tooltip" data-placement="top" title="Tamplikan Lengkap" href="@Url.Action("DaftarSKN", "BPDP")"><i class="fa fa-th-list"></i></a>
                    </div>
                    <h3 class="m-b-xs">TRANSAKSI SKN / Kliring</h3>
                    <small>Menampilkan 10 transaksi terakhir SKN / Kliring</small>
                </div>
                <div class="panel-body">
                    <div class="table-responsive">
                        <table id="dtDaftarSKN" class="table table-striped table-bordered table-hover" cellpadding="0" style="width:100%">
                            <thead>
                                <tr>
                                    <th class="text-center">No</th>
                                    <th class="text-center" hidden>Id</th>
                                    <th class="text-center">No. Trans</th>
                                    <th class="text-center">Tanggal</th>
                                    <th class="text-center">Nama Penerima</th>
                                    <th class="text-center">Nama Bank</th>
                                    <th class="text-center">Rek. Tujuan</th>
                                    <th class="text-center">Nominal</th>
                                    <th class="text-center">Biaya</th>
                                    <th class="text-center">Keterangan</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Styles {
    <environment names="Staging,Production,Development">
        <link rel="stylesheet" href="~/lib/toastr/lib/toastr.min.css" />
        <link rel="stylesheet" href="~/lib/datatables.net-bs/css/dataTables.bootstrap.min.css" />
    </environment>
}

@section Scripts {
    <environment names="Development,Staging,Production">
        <script src="~/lib/datatables/media/js/jquery.dataTables.min.js"></script>
        <script src="~/lib/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
        <script src="~/lib/pdfmake/build/pdfmake.min.js"></script>
        <script src="~/lib/pdfmake/build/vfs_fonts.js"></script>
        <script src="~/lib/datatables.net-buttons/js/buttons.html5.min.js"></script>
        <script src="~/lib/datatables.net-buttons/js/buttons.print.min.js"></script>
        <script src="~/lib/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
        <script src="~/lib/datatables.net-buttons-bs/js/buttons.bootstrap.min.js"></script>

        <script src="~/lib/moment/moment.js"></script>
    </environment>

    <script type="text/javascript">

        $(document).ready(function () {
            $(document).idleTimer(300000);

            ProfilePiture();

            GetDashboardInfo();
            GetTransaksiInHouse();
            GetTransaksiRTGS();
            GetTransaksiSKN();
        });

        // Idle Time
        $(document).on("idle.idleTimer", function (event, elem, obj) {
            window.location = '@Url.Action("Login", "User")';
        });

        function sleep(milliseconds) {
            var start = new Date().getTime();
            for (var i = 0; i < 1e7; i++) {
                if ((new Date().getTime() - start) > milliseconds) {
                    break;
                }
            }
        };

        setInterval(function () { ReloadDaftar(); }, 25000);

        function GetTransaksiInHouse() {
            $('#dtDaftarInHouse').DataTable().destroy();
            $('#dtDaftarInHouse').DataTable({
                ajax: {
                    url: '@Url.Action("GelListInHouse", "BPDP")',
                    dataSrc: '[]',
                    type: 'POST',
                    data: { TOT_REC: 10 },
                    async: true
                    //error: function (xhr, error, code) {
                    //    swal.fire('Kesalahan', 'Maaf, gagal mengambil data dari server', 'error')
                    //}
                },
                columns: [
                    { data: null, className: 'text-center', width: '5%', render: function (data, type, row, meta) { return meta.row + 1; } },
                    { data: 'ID_BPDP_TRANS', className: 'id hidden', render: function (data, type, row) { return data } },
                    { data: 'NO_TRANS', className: 'text-center', width: '10%', render: function (data, type, row) { return data } },
                    { data: 'TANGGAL', className: 'text-center', render: function (d) { return moment(d).format("DD/MM/YYYY") } },
                    { data: 'NAMA_PENERIMA', width: '25%' },
                    { data: 'NOREK_KREDIT', className: 'text-center', width: '10%' },
                    { data: 'NOMINAL_KREDIT', className: 'text-right', width: '10%', render: $.fn.dataTable.render.number('.', ',', 2) },
                    { data: 'KETERANGAN', className: 'text-center', width: '25%' }
                ],
                autoWidth: false,
                oLanguage: { sSearch: 'Cari:' },
                drawCallback: function (settings) {
                    //if (!$('#dtDaftarUser').parent().hasClass("table-responsive")) {
                    //    $('#dtDaftarUser').wrap("<div class='table-responsive'></div>");
                    //}

                    $('[data-toggle="tooltip"]').tooltip();
                }
            });
        }

        function GetTransaksiRTGS() {
            $('#dtDaftarRTGS').DataTable().destroy();
            $('#dtDaftarRTGS').DataTable({
                ajax: {
                    url: '@Url.Action("GelListRTGS", "BPDP")',
                    dataSrc: '[]',
                    type: 'POST',
                    data: { TOT_REC: 10 },
                    async: true
                    //error: function (xhr, error, code) {
                    //    swal.fire('Kesalahan', 'Maaf, gagal mengambil data dari server', 'error')
                    //}
                },
                columns: [
                    { data: null, className: 'text-center', width: '5%', render: function (data, type, row, meta) { return meta.row + 1; } },
                    { data: 'ID_BPDP_RTGS_TRANS', className: 'id hidden', render: function (data, type, row) { return data } },
                    { data: 'NO_TRANS', className: 'text-center', width: '10%', render: function (data, type, row) { return data } },
                    { data: 'TANGGAL', className: 'text-center', render: function (d) { return moment(d).format("DD/MM/YYYY") } },
                    { data: 'NAMA_PENERIMA', width: '25%' },
                    { data: 'BANK_PENERIMA', className: 'text-center', width: '15%' },
                    { data: 'NOREK_PENERIMA', className: 'text-center', width: '10%' },
                    { data: 'NOMINAL', className: 'text-right', width: '10%', render: $.fn.dataTable.render.number('.', ',', 2) },
                    { data: 'BIAYA', className: 'text-right', width: '10%', render: $.fn.dataTable.render.number('.', ',', 2) },
                    { data: 'KETERANGAN', className: 'text-center', width: '25%' }
                ],
                autoWidth: false,
                oLanguage: { sSearch: 'Cari:' },
                drawCallback: function (settings) {
                    //if (!$('#dtDaftarUser').parent().hasClass("table-responsive")) {
                    //    $('#dtDaftarUser').wrap("<div class='table-responsive'></div>");
                    //}

                    $('[data-toggle="tooltip"]').tooltip();
                }
            });
        }

        function GetTransaksiSKN() {
            $('#dtDaftarSKN').DataTable().destroy();
            $('#dtDaftarSKN').DataTable({
                ajax: {
                    url: '@Url.Action("GelListSKN", "BPDP")',
                    dataSrc: '[]',
                    type: 'POST',
                    data: { TOT_REC: 10 },
                    async: true
                    //error: function (xhr, error, code) {
                    //    swal.fire('Kesalahan', 'Maaf, gagal mengambil data dari server', 'error')
                    //}
                },
                columns: [
                    { data: null, className: 'text-center', width: '5%', render: function (data, type, row, meta) { return meta.row + 1; } },
                    { data: 'ID_BPDP_SKN_TRANS', className: 'id hidden', render: function (data, type, row) { return data } },
                    { data: 'NO_TRANS', className: 'text-center', width: '10%', render: function (data, type, row) { return data } },
                    { data: 'TANGGAL', className: 'text-center', render: function (d) { return moment(d).format("DD/MM/YYYY") } },
                    { data: 'NAMA_PENERIMA', width: '25%' },
                    { data: 'BANK_PENERIMA', className: 'text-center', width: '15%' },
                    { data: 'NOREK_PENERIMA', className: 'text-center', width: '10%' },
                    { data: 'NOMINAL', className: 'text-right', width: '10%', render: $.fn.dataTable.render.number('.', ',', 2) },
                    { data: 'BIAYA', className: 'text-right', width: '10%', render: $.fn.dataTable.render.number('.', ',', 2) },
                    { data: 'KETERANGAN', className: 'text-center', width: '25%' }
                ],
                autoWidth: false,
                oLanguage: { sSearch: 'Cari:' },
                drawCallback: function (settings) {
                    //if (!$('#dtDaftarUser').parent().hasClass("table-responsive")) {
                    //    $('#dtDaftarUser').wrap("<div class='table-responsive'></div>");
                    //}

                    $('[data-toggle="tooltip"]').tooltip();
                }
            });
        }

        function GetDashboardInfo() {
            $.get('@Url.Action("GetDashboard", "BPDP")', function (result) {
                var obj = JSON.parse(JSON.stringify(result));

                $('#totInHouse').html(obj.totInHouse);
                $('#totRTGS').html(obj.totRTGS);
                $('#totSKN').html(obj.totSKN);
            });
        }

        function ReloadDaftar() {
            GetDashboardInfo();
            $('#dtDaftarInHouse').DataTable().ajax.reload(null, false);
            $('#dtDaftarRTGS').DataTable().ajax.reload(null, false);
            $('#dtDaftarSKN').DataTable().ajax.reload(null, false);
        }
    </script>
}